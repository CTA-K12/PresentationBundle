{% extends 'MesdPresentationBundle::splash.html.twig' %}
{% trans_default_domain "mesd_presentation" %}

{% block navbarContentLeft %}
{% endblock navbarContentLeft %}

{% block navbarContentRight %}
{% endblock navbarContentRight %}

{% block containerOuter %}

    <div id="container-outer" class="container-outer wrapper">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    {% block subtitle %}
                        {% if subtitle is defined %}
                            <h1 class="page-title">{{ subtitle|raw }}</h1>
                        {% elseif pagetitle is defined %}
                            <h1 class="page-title">{{ pagetitle|raw }}</h1>
                        {% else %}
                            <h1>
                                <span class="fa fa-lock"></span>&nbsp;
                                {{ '%app%.login'|trans({'%app%': mesd_presentation_app_name}) }}
                            </h1>
                        {% endif %}
                    {% endblock subtitle %}
                </div>
                <div class="modal-body">
                    {% block panelBody %}
                        {#} See:
                                http://symfony.com/doc/current/cookbook/security/remember_me.html#forcing-the-user-to-re-authenticate-before-accessing-certain-resources
                            for more information
                        {#}
                        {% if is_granted("IS_AUTHENTICATED_REMEMBERED") %}
                            <div class="alert alert-warning" role="alert">
                                <button type="button" class="close" data-dismiss="alert">
                                    <span aria-hidden="true">&times;</span>
                                    <span class="sr-only">{{ 'close'|trans }}</span>
                                </button>
                                <span class="fa fa-exclamation-circle"></span>
                                <strong>{{ 'already.logged.in'|trans }}</strong>
                                {{ 'logged.in.as.%username%'|trans({'%username%': app.user.username }) }}
                            </div>
                        {% else %}
                            {% if error %}
                                <div class="alert alert-danger alert-dismissible" role="alert">
                                    <button type="button" class="close" data-dismiss="alert">
                                        <span aria-hidden="true">&times;</span>
                                        <span class="sr-only">{{ 'close'|trans }}</span>
                                    </button>
                                    <span class="fa fa-exclamation-triangle"></span>
                                    <strong>{{ 'error'|trans }}</strong> {{ error.messageKey }}
                                </div>
                            {% endif %}
                            <form action="{{ routeHelper(mesd_presentation_login_check_path) }}" method="post" role="form">
                                <input type="hidden" name="_csrf_token" value="{{ csrf_token }}" />
                                <div class="form-group">
                                    <label for="username">{{ 'username.or.email'|trans }}</label>
                                    <div class="input-group">
                                        <div class="input-group-addon"><span class="fa fa-user"></span></div>
                                        <input
                                            type="text"
                                            id="username"
                                            name="_username"
                                            class="form-control"
                                            placeholder="{{ 'username'|trans }}"
                                            value="{{ last_username }}"
                                            tabindex="1"
                                            {% if last_username is empty %}autofocus{% endif %}
                                            required
                                            {% if 'dev' != app.environment %}
                                                autocomplete="off"
                                                oncopy="return false;"
                                                oncut="return false;"
                                                onpaste="return false;"
                                                oncontextmenu="return false;"
                                            {% endif %}
                                        />
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="password">{{ 'password'|trans }}</label>
                                    <div class="input-group">
                                        <div class="input-group-addon"><span class="fa fa-key"></span></div>
                                        <input
                                            type="password"
                                            id="password"
                                            name="_password"
                                            class="form-control"
                                            placeholder="{{ 'password'|trans }}"
                                            tabindex="2"
                                            {% if last_username is not empty %}autofocus{% endif %}
                                            required
                                            {% if 'dev' != app.environment %}
                                                autocomplete="off"
                                                oncopy="return false;"
                                                oncut="return false;"
                                                onpaste="return false;"
                                                oncontextmenu="return false;"
                                            {% endif %}
                                        />
                                    </div>
                                </div>
                        {% endif %}
                    {% endblock panelBody %}
                </div>
                <div class="modal-footer">
                    {% block panelFooter %}
                        {% if is_granted("IS_AUTHENTICATED_REMEMBERED") %}
                            <div class="row">
                                <div class="col-xs-5-12">
                                    <a href=".." title="{{ 'home'|trans }}" class="btn btn-default form-control">
                                        <span class="fa fa-home"></span>&nbsp;
                                        {{ 'home'|trans }}
                                    </a>
                                </div>
                                <div class="col-xs-5-12 col-xs-offset-1-6">
                                    <a href="{{ routeHelper(mesd_presentation_logout_path) }}" title="{{ 'logout'|trans }}" class="btn btn-default form-control">
                                        <span class="fa fa-sign-out"></span>&nbsp;
                                        {{ 'logout'|trans }}
                                    </a>
                                </div>
                            </div>
                        {% else %}
                                {% if mesd_presentation_allow_registration %}
                                    {#
                                        Users shouldn't be setting the text on labels
                                        from the config if they are using translations.
                                        Either way, they should just override the
                                        template if they want to customize the text.

                                        After more thought, I'll decide if these
                                        configurable parameters should be removed.
                                    #}
                                    {#
                                        1.
                                        <a href="{{ routeHelper(mesd_presentation_registration_path) }}" class="btn btn-link">{{ mesd_presentation_registration_text }}</a>
                                    #}
                                    <a href="{{ routeHelper(mesd_presentation_registration_path) }}" class="btn btn-link">
                                        {{ 'register'|trans }}
                                    </a>
                                {% endif %}
                                {% if mesd_presentation_allow_password_reset %}
                                    {#
                                        2.
                                        <a href="{{ routeHelper(mesd_presentation_password_reset_path) }}" class="btn btn-link">{{ mesd_presentation_password_reset_text }}</a>
                                    #}
                                    <a href="{{ routeHelper(mesd_presentation_password_reset_path) }}" class="btn btn-link">
                                        {{ 'forgot.password'|trans }}
                                    </a>
                                {% endif %}
                                <button type="submit" name="login" class="btn btn-primary">
                                    <span class="fa fa-sign-in"></span>&nbsp;
                                    {{ 'login'|trans }}
                                </button>
                            </form>
                        {% endif %}
                    {% endblock panelFooter %}
                </div>
            </div>
        </div>
    </div>

{% endblock containerOuter %}