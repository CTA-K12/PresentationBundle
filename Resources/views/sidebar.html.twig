{% import _self as ulli %}

{% if 'inline' == type %}
    {% set sidebarclass = 'sidebar sidebar-inline' %}
{% elseif 'dropdown' == type %}
    {% set sidebarclass = 'sidebar sidebar-dropdown' %}
{% else %}
    {% set sidebarclass = 'sidebar' %}
{% endif %}
{% if 'dropdown' == type %}
    <div class="navbar">
        <div class="btn btn-navbar" data-toggle="collapse" data-target=".sidebar-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </div><!-- END btn-navbar -->
        <div class="nav-collapse sidebar-collapse">
{% endif %}

<nav>
    <ul class="nav">
        {{ ulli.maker(menu, 1) }}
    </ul>
</nav>

{% if 'dropdown' == type %}
        </div><!-- END nav-collapse -->
    </div><!-- END navbar -->
{% endif %}

{% block sidebarshim %}
    <div class="drag-bar" style="left: {{app.request.cookies.get('MesdPresentationSidebarSize')}}px;">
        <div class="drag-bar-handle">
            <span class="dot"></span>
            <span class="dot"></span>
            <span class="dot"></span>
        </div><!-- END drag-bar-handle -->
    </div><!-- END drag-bar -->
{% endblock sidebarshim %}

{% macro maker(list, level) %}
    {% import _self as ulli %}
    {% for text, item in list %}
        <li{% if item.active is defined and item.active == true %} class="active"{% endif %}>
            <a href="{{ item.path is null ? '#' : item.path }}" title="{{ item.title is defined ? item.title : title }}">
                <span class="fa icon {{ item.icon }}"></span>
                <span class="pull-right hideable">
                    {% if item.text is defined %}
                        {{ item.text }}
                    {% else %}
                        {{ text }}
                    {% endif %}
                    {% if item.children is defined and 0 < item.children|length %}
                        <span class="fa fa-plus-square-o"></span>
                    {% endif %}
                </span>
            </a>
            {% if item.children is defined and 0 < item.children|length %}
                <ul>
                    {{ ulli.maker(item.children) }}
                </ul>
            {% endif %}
        </li>
    {% endfor %}
{% endmacro %}